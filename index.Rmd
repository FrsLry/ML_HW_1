--- 
title: | # if you indicate the tile, it'll create a new cover page
  | Introduction to Machine Learning
  | (NPFL054)
# coverpage: true # will take the _assets/coverpage.pdf file as cover page
subtitle: "Homework 1"
author: "François Leroy, PhD student at CZU"
date: "`r Sys.Date()`"

## This line is to use when you want several outputs (specified in output.yml)
site: bookdown::bookdown_site

## The default class 
documentclass: report
classoption: oneside # really important!!!!


# Set font features
fontsize: 12pt
linestretch: 1.5

# Geometry for the PDF: 
# (seems to provoc a warning message linked to biblatex)
geometry:
  - left = 2cm
  - right = 2cm
  - top = 2cm
  - bottom = 2cm

# LOF and LOT for the PDF
# lof: true
# lot: yes

## to colorize the biblio ref and the URLs
colorlinks: true 


# Biblio for the PDF: please note that the name of the .bib file must be as simple as possible (e.g. no underscore)
# bibliography:
#  - references.bib
# biblio-style: apa
# biblio-title:  ## note: the name and label of the bib part is in the template!!!

link-citations: yes
github-repo: FrsLry/HW1_ML_CUNI_leroy
---

```{r, echo = F}
knitr::opts_chunk$set(warning = F,
                      message = F)
```

# Multiple linear regression {#q1}


## 

```{r}
library(ISLR)
library(tidyverse)
```

```{r}
# Perform the multiple linear regression
lm <- 
  lm(mpg ~ ., data = subset(Auto, select = -name))
# Print the output
summary(lm)
```

First of all, the adjusted $R^2 = 0.82$, which means that 82% of the variance of the data is explained by this models. This is a very trustful model. 


Here, I will talk about only about the covariates that have a significant influence (*i.e.* $p-value \leq 0.05$) on the `mpg` variable (*i.e.* rows with an asterix such as `displacement`, `weight`, `year` and `origin`):

* The miles per galon unit (*i.e.* `mpg`) expresses the fuel economy of a vehicle. Thus, when the coefficient of the `lm` is negative, it means that the vehicle will tend to go less further with a unit of fuel. Here, this is the case for the `weight` variable: a heavier vehicle will consume more fuel than a lighter one. 

* The other significant relationships with the `displacement`, `year` and `origin` are positive which means that a more recent car, with a higher displacement volume and with a higher origin will tend to consume less fuel. 

\newpage

## 

```{r}
## Perform the 5 polynomial simpple linear regression
for (i in 1:5){
  assign(paste0("fit", i),
         lm(mpg ~ poly(acceleration, i), data = subset(Auto, select = -name)))
}
## Plot them on a single plot
#### First merge the predicted values of mpg with the acceleration
Auto %>% 
  select(acceleration) %>% 
  cbind(poly1 = fit1$fitted.values,
        poly2 = fit2$fitted.values,
        poly3 = fit3$fitted.values,
        poly4 = fit4$fitted.values,
        poly5 = fit5$fitted.values) %>%
##### Then format the data for ggplot  
  pivot_longer(cols = poly1:poly5,
               names_to = "poly",
               values_to = "mpg") %>% 
  mutate(rsq = case_when(
    poly == "poly1" ~ round(summary(fit1)$adj.r.squared, digits = 2),
    poly == "poly2" ~ round(summary(fit2)$adj.r.squared, digits = 2),
    poly == "poly3" ~ round(summary(fit3)$adj.r.squared, digits = 2),
    poly == "poly4" ~ round(summary(fit4)$adj.r.squared, digits = 2),
    poly == "poly5" ~ round(summary(fit5)$adj.r.squared, digits = 2)
  )) %>% 
  unite(poly, c("poly", "rsq"), sep = ", adj.R² = ") %>% 
#### Now plot it
  ggplot()+
  geom_point(aes(acceleration, mpg), data = subset(Auto, select = -name))+
  geom_line(aes(acceleration, mpg, color = poly), size = 1.2)+
  theme_classic()
```


